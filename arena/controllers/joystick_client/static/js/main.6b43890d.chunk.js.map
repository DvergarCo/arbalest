{"version":3,"sources":["Joystick.js","App.js","index.js"],"names":["JoyStick","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","nippleRef","React","createRef","manager","nipplejs","create","mode","maxNumberOfNipples","color","zone","current","listener","react_default","a","createElement","ref","style","joyStyle","Component","flex","background","borderRadius","SEND_INTERVAL","RECONNECT_TIMEOUT","robots","document","body","margin","App","state","status","robotId","angle","force","sender","connecter","connect","conn","WebSocket","window","location","hostname","onopen","setState","clearTimeout","setInterval","sendDirection","onclose","clearInterval","setTimeout","onerror","e","_assertThisInitialize","assertThisInitialized","send","concat","on","stick","radian","onRobotSelection","_this2","_this$state","display","flexDirection","position","width","height","boxSizing","padding","menuStyle","map","id","onClick","key","joystickContainer","Joystick","ReactDOM","render","src_App","getElementById"],"mappings":"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","file":"static/js/main.6b43890d.chunk.js","sourcesContent":["import React, { Component } from \"react\";\nimport nipplejs from \"nipplejs\";\n\nclass JoyStick extends Component {\n  constructor(props) {\n    super(props);\n    this.nippleRef = React.createRef();\n  }\n\n  componentDidMount() {\n    this.manager = nipplejs.create({\n      mode: \"dynamic\",\n      maxNumberOfNipples: 1,\n      color: \"#fff\",\n      zone: this.nippleRef.current\n    });\n    this.props.listener(this.manager);\n  }\n\n  render() {\n    return <div ref={this.nippleRef} style={joyStyle} />;\n  }\n}\n\nconst joyStyle = {\n  flex: 1,\n  background: \"#000\",\n  borderRadius: \"12px\"\n};\n\nexport default JoyStick;\n","import React, { Component } from \"react\";\nimport nipplejs from \"nipplejs\";\nimport JoyStick from \"./Joystick\";\n\n// keep constant sending speed for webots\nconst SEND_INTERVAL = 150;\nconst RECONNECT_TIMEOUT = 5000;\n\nconst robots = [0, 1, 2, 3];\n\ndocument.body.style.margin = \"0px\";\n\nclass App extends Component {\n  state = {\n    status: \"connecting\",\n    robotId: robots[0]\n  };\n\n  angle = 0;\n  force = 0;\n  sender = null;\n  connecter = null;\n\n  componentDidMount() {\n    this.connect();\n  }\n\n  connect = () => {\n    this.conn = new WebSocket(\"ws://\" + window.location.hostname + \":9000\");\n\n    this.conn.onopen = () => {\n      this.setState({ status: \"connected\" });\n      clearTimeout(this.connecter);\n      this.sender = setInterval(this.sendDirection, SEND_INTERVAL);\n    };\n\n    this.conn.onclose = () => {\n      this.setState({ status: \"closed\" });\n      clearInterval(this.sender);\n      this.connecter = setTimeout(this.connect, RECONNECT_TIMEOUT);\n    };\n\n    this.conn.onerror = e => {\n      this.setState({ status: \"error\" });\n      clearInterval(this.sender);\n      this.connecter = setTimeout(this.connect, RECONNECT_TIMEOUT);\n    };\n  };\n\n  sendDirection = () => {\n    const { robotId } = this.state;\n    const { angle, force } = this;\n    if (this.conn) this.conn.send(`${robotId}:${angle}|${force}`);\n  };\n\n  listener = manager => {\n    manager.on(\"move\", (e, stick) => {\n      if (stick.angle) {\n        this.angle = stick.angle.radian;\n        this.force = stick.force;\n      }\n    });\n    manager.on(\"end\", () => {\n      this.angle = 0;\n      this.force = 0;\n    });\n  };\n\n  onRobotSelection = robotId => {\n    this.setState({ robotId });\n  };\n\n  render() {\n    const { status, robotId } = this.state;\n\n    const containerStyle = {\n      display: \"flex\",\n      flexDirection: \"column\",\n      position: \"relative\",\n      width: \"100%\",\n      height: \"100vh\",\n      boxSizing: \"border-box\",\n      padding: \"0.5em\"\n    };\n\n    return (\n      <div style={containerStyle}>\n        <div style={menuStyle}>\n          <div>\n            <div>Status: {status}</div>\n          </div>\n          {robots.map(id => (\n            <button\n              onClick={() => this.onRobotSelection(id)}\n              key={id}\n              style={{\n                margin: \"1em\",\n                color: id === robotId ? \"red\" : \"black\"\n              }}\n            >\n              Robot {id}\n            </button>\n          ))}\n        </div>\n        <div style={joystickContainer}>\n          {status === \"connected\" && <JoyStick listener={this.listener} />}\n        </div>\n      </div>\n    );\n  }\n}\n\nconst joystickContainer = {\n  flex: 1,\n  display: \"flex\",\n  flexDirection: \"column\",\n  position: \"relative\"\n};\n\nconst menuStyle = {\n  flex: 0,\n  margin: \"0.5em\",\n  background: \"#fff\"\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n"],"sourceRoot":""}